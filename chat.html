<html>
    <p>
       <input type="text" id="ip" value="169.254.112.200"></input>
       <button type=button onclick="new_connection()">New Connection</button>
    </p>
    <p>
        <textarea type="textarea" id="output"></textarea>
    </p>
    <p> 
        <input type="text" id="input"> </input>
       <button type=button onclick="send()">Send </button>
    </p>
    <p>
    </p>
    <p>
       <button type=button onclick="start()">Start </button> 
       <input type="text" id="players" value=1></input>
       <button type=button onclick="stop()">Stop </button>
       <button type=button onclick="pause()">Pause </button>
       <button type=button onclick="resume()">Resume </button>
       <button type=button onclick="shutdown()">Shutdown </button>
       <button type=button onclick="status()">Status </button>
    </p>
    <p>
    <list>
       <li>
       <button type=button onclick="load(0)">Load Chapter - Orientation</button>
       </li>
       <li>
       <button type=button onclick="load(1)">Load Chapter - Intro</button>
       </li>
       <li>
       <button type=button onclick="load(2)">Load Chapter - Hoist</button>
       </li>
       <li>
       <button type=button onclick="load(3)">Load Chapter - Fog</button>
       </li>
       <li>
       <button type=button onclick="load(4)">Load Chapter - Minefield</button>
       </li>
       <li>
       <button type=button onclick="load(5)">Load Chapter - Hard Landing</button>
       </li>
       <li>
       <button type=button onclick="load(6)">Load Chapter - Soft Landing</button>
       </li>
       <li>
       <button type=button onclick="load(7)">Load Chapter - Epilogue</button>
       </li>
    </list>
    </p>
</html>

<script>

id="1";

ip = document.getElementById("ip").value;
console.log("ip is "+ ip);
socket = new WebSocket("ws://"+ip+":9000");

socket.onopen = function(e) {
    console.log("open");
};

socket.onerror = function(e) {
    console.log("error on open");
};

socket.onmessage = function(event) {
    console.log("got a message " + event.data);
    textbox=document.getElementById("output");
    textbox.value = event.data + '\n' + textbox.value;
};

socket.onclose = function(event) {
    console.log("on close");
};

function send() {
    console.log("send button");
    textbox=document.getElementById("input");
    socket.send(textbox.value);
}
function pause()
{
    simple_cmd("pause");
}
function start()
{
    class complexCmd {
      id;
      cmd;
      players;
    };
    d = new complexCmd();
    d.id = 1;
    d.cmd = "start";
    d.players = document.getElementById("players").value;
    cmd = JSON.stringify(d);
    console.log("sending "+cmd);
    socket.send(cmd);
}
function stop()
{
    simple_cmd("stop");
}
function resume()
{
    simple_cmd("resume");
}
function shutdown()
{
    simple_cmd("shutdown");
}
function status()
{
    simple_cmd("status");
}
function simple_cmd(a) {
    class simpleCmd {
        id;
        cmd;
    } 
    d = new simpleCmd();
    d.id = 1;
    d.cmd = a;
    cmd = JSON.stringify(d);
    console.log("sending "+cmd);
    socket.send(cmd);
}
function load(a)
{
    const title =["Orientation","Intro",
               "Hoist","Fog",
               "Minefield",
               "Hard Landing",
               "Soft Landing",
               "Epilogue"];    

    class loadCmd {
       cmd;
       title;
       id;
    }
    d = new loadCmd();
    d.cmd="load";
    d.title=title[a];
    d.id = 1;
    cmd = JSON.stringify(d);
    console.log("sending "+cmd);
    socket.send(cmd);
}
function new_connection()
{
    ip = document.getElementById("ip").value;
    console.log("ip is "+ ip);
    socket = new WebSocket("ws://"+ip+":9000");
    textbox=document.getElementById("output");
    textbox.value = "";
}
</script>
