<html>
    <form>
        <input type="text" id="output">
        <input type="text" id="input"> </input>
       <button type=button onclick="send()">Send </button>
    </form>
    <p>
    </p>
    <p>
       <button type=button onclick="start()">Start </button> 
       <input type="text" id="players" value=1></input>
       <button type=button onclick="stop()">Stop </button>
       <button type=button onclick="pause()">Pause </button>
       <button type=button onclick="resume()">Resume </button>
       <button type=button onclick="shutdown()">Shutdown </button>
       <button type=button onclick="status()">Status </button>
    </p>
    <p>
    <list>
       <li>
       <button type=button onclick="load(0)">Load Chapter - Orientation</button>
       </li>
       <li>
       <button type=button onclick="load(1)">Load Chapter - Intro</button>
       </li>
       <li>
       <button type=button onclick="load(2)">Load Chapter - Hoist</button>
       </li>
       <li>
       <button type=button onclick="load(3)">Load Chapter - Fog</button>
       </li>
       <li>
       <button type=button onclick="load(4)">Load Chapter - Minefield</button>
       </li>
       <li>
       <button type=button onclick="load(5)">Load Chapter - Hard Landing</button>
       </li>
       <li>
       <button type=button onclick="load(6)">Load Chapter - Soft Landing</button>
       </li>
       <li>
       <button type=button onclick="load(7)">Load Chapter - Epilogue</button>
       </li>
    </list>
    </p>
</html>

<script>

    //not sure why this has to be done...
    // hack
textbox=document.getElementById("output");
textbox.value = textbox.value="";
textbox=document.getElementById("input");
textbox.value = textbox.value="";
    // end hack
let socket = new WebSocket("ws://169.254.112.122:9000");

socket.onopen = function(e) {
    console.log("open");
};

socket.onerror = function(e) {
    console.log("error on open");
};
socket.onmessage = function(event) {
    textbox=document.getElementById("output");
    textbox.value = textbox.value+event.msg;

    // now decide if it is formatted in a way that is understood
    // and if so, put it in an object
    if (textbox.value.indexOf("status")) {
        // the string has 'status' in it, so lets consider it to be 
    }
};

socket.onclose = function(event) {
};

socket.onerror = function(error) {
  console.log("error");
};
function send() {
    console.log("send button");
    textbox=document.getElementById("input");
    socket.send(textbox.value);
}
function pause()
{
    cmd="{\"cmd\":\"pause\"}";
    console.log("sending "+cmd);
    socket.send(cmd);
}
function start()
{
    cmd="{\"cmd\":\"start\"}";
    let t=document.getElementById("players").value;
    console.log("sending "+cmd+"players:"+t);
    socket.send(cmd);
}
function stop()
{
    cmd="{\"cmd\":\"stop\"}";
    console.log("sending "+cmd);
    socket.send(cmd);
}
function resume()
{
    cmd="{\"cmd\":\"resume\"}";
    console.log("sending "+cmd);
    socket.send(cmd);
}
function shutdown()
{
    cmd="{\"cmd\":\"shutdown\"}";
    console.log("sending "+cmd);
    socket.send(cmd);
}
function status()
{
    cmd="{\"cmd\":\"status\"}";
    console.log("sending "+cmd);
    socket.send(cmd);
}
function load(a)
{
    cmd="{\"cmd\":\"load\"}";
    const title =["Load Chapter - Orientation","Load Chapter - Intro",
               "Load Chapter - Hoist","Load Chapter - Fog",
               "Load Chapter - Minefield",
               "Load Chapter - Hard Landing",
               "Load Chapter - Soft Landing",
               "Load Chapter - Epilogue"];    
    console.log("sending "+cmd+" " + title[a]);
    socket.send(cmd);
}
</script>
